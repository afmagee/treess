test_that("Test matrix permutation.", {
  # Get and permute distance matrix with fixed seed
  x <- withr::with_seed(42,rnorm(10))
  m <- as.matrix(dist(x))
  permute <- withr::with_seed(42,permuteDistanceMatrix(m, FALSE))
  
  vec <- as.numeric(permute)
  expected <- c(0.0000000000000000, 0.9666901240056694, 1.4336725461990896, 1.4656174855597661, 1.9356566185427573, 0.7380958421856281, 1.4770829632381526, 0.6474652667303733, 0.1405635502922704, 1.0078300358093293, 0.9666901240056694, 0.0000000000000000, 0.4669824221934200, 0.4989273615540966, 0.9689664945370877, 0.2285942818200414, 0.5103928392324830, 1.6141553907360429, 1.1072536742979397, 0.0411399118036598, 1.4336725461990896, 0.4669824221934200, 0.0000000000000000, 0.0319449393606766, 0.5019840723436677, 0.6955767040134614, 0.0434104170390630, 2.0811378129294629, 1.5742360964913600, 0.4258425103897602, 1.4656174855597661, 0.4989273615540966, 0.0319449393606766, 0.0000000000000000, 0.4700391329829912, 0.7275216433741379, 0.0114654776783865, 2.1130827522901394, 1.6061810358520365, 0.4577874497504367, 1.9356566185427573, 0.9689664945370877, 0.5019840723436677, 0.4700391329829912, 0.0000000000000000, 1.1975607763571290, 0.4585736553046046, 2.5831218852731306, 2.0762201688350275, 0.9278265827334279, 0.7380958421856281, 0.2285942818200414, 0.6955767040134614, 0.7275216433741379, 1.1975607763571290, 0.0000000000000000, 0.7389871210525244, 1.3855611089160014, 0.8786593924778985, 0.2697341936237012, 1.4770829632381526, 0.5103928392324830, 0.0434104170390630, 0.0114654776783865, 0.4585736553046046, 0.7389871210525244, 0.0000000000000000, 2.1245482299685259, 1.6176465135304230, 0.4692529274288232, 0.6474652667303733, 1.6141553907360429, 2.0811378129294629, 2.1130827522901394, 2.5831218852731306, 1.3855611089160014, 2.1245482299685259, 0.0000000000000000, 0.5069017164381029, 1.6552953025397026, 0.1405635502922704, 1.1072536742979397, 1.5742360964913600, 1.6061810358520365, 2.0762201688350275, 0.8786593924778985, 1.6176465135304230, 0.5069017164381029, 0.0000000000000000, 1.1483935861015997, 1.0078300358093293, 0.0411399118036598, 0.4258425103897602, 0.4577874497504367, 0.9278265827334279, 0.2697341936237012, 0.4692529274288232, 1.6552953025397026, 1.1483935861015997, 0.0000000000000000)
  
  expect_equal(vec,expected,tolerance=1e-10)
})